<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>MarkLogic Fundamentals</title>
<link href="../css/ml.css" rel="stylesheet" type="text/css">
</head>

<body>
<p><img src="../images/general/Marklogic-University-RGB.png" alt="" width="130" height="38" class="logo-padding"/></p>
<p class="exercise-heading">Exercise: <strong>Serve Data to a BI Tool</strong></p>
<p>In this walkthrough exercise, you create a template for the star-wars database, so that  SQL queries can be made to the database.</p>
<p>&nbsp;</p>
<ol class="exercise-step">
  <li class="exercise-step">In Query Console, select the <strong>star-wars</strong> database and click the <strong>Explore</strong> button.</li>
  <li class="exercise-step"><strong>Click</strong> one of the documents (e.g. /character/lukeskywalker.json).</li>
  <li class="exercise-step"><strong>Skim</strong> the document:<br>
    <br>
    <img src="../images/unit06/luke.png" width="554" height="335" class="image-border"><br>
  </li>
  <li class="exercise-step"><strong>Imagine</strong> wanting to be able to make SQL queries against the name, role, height, homeworld, and alliance properties. </li>
  <li class="exercise-step">In the <strong>Admin Interface</strong>, select <strong>Configure</strong> - <strong>Databases</strong> - <strong>star-wars</strong>.</li>
  <li class="exercise-step">For schema database, select <strong>Schemas</strong>:<br>
    <br>
    <img src="../images/unit06/schema.png" width="448" height="228" class="image-border"><br>
    <br>
    <em>Note: The schema database is where the template will be stored</em><br>
  </li>
  <li class="exercise-step">Click the <strong>ok</strong> button.</li>
  <li class="exercise-step">In <strong>Query Console</strong>, in the workspace menu (upper-right corner), select <strong>Import Workspace...</strong></li>
  <li class="exercise-step">Click the <strong>Browse...</strong> button.</li>
  <li class="exercise-step">Navigate to mls-fundamentals/<strong>unit06</strong>.</li>
  <li class="exercise-step">Select<strong> Use a Template</strong>.xml.</li>
  <li class="exercise-step">Click the <strong>Open </strong>button.</li>
  <li class="exercise-step">Click the <strong>Import </strong>button.</li>
  <li class="exercise-step">On the first tab,<strong> Insert Template</strong>, see that a view named characters is being defined, with columns for name, role, height, homeworld, and alliance:<br>
    <br>
    <span class="code">'use strict';<br>
    <br>
    const tde = require ('/MarkLogic/tde');<br>
    <br>
    const charactersTemplate = xdmp.toJSON(<br>
    {<br>
      'template':{<br>
        'context':'/id',<br>
        'rows':[<br>
        {<br>
          'schemaName':'starwars',<br>
          'viewName':'characters',<br>
          'columns':[<br>
          {<br>
        'name':'name',<br>
        'scalarType':'string',<br>
        'val':'../name',<br>
        'nullable':true<br>
      },<br>
          {<br>
            'name':'role',<br>
            'scalarType':'string',<br>
            'val':'../role',<br>
        'nullable':true<br>
          },<br>
          {<br>
            'name':'height',<br>
            'scalarType':'decimal',<br>
            'val':'../height',<br>
        'nullable':true<br>
          },<br>
          {<br>
            'name':'homeworld',<br>
            'scalarType':'string',<br>
            'val':'../homeworld',<br>
            'nullable':true<br>
          },<br>
          {<br>
            'name':'alliance',<br>
            'scalarType':'string',<br>
            'val':'../alliance',<br>
            'nullable':true<br>
          }<br>
          ]<br>
        }]<br>
      }<br>
    }<br>
    );<br>
    <br>
    tde.templateInsert('/templates/charactersTemplate.json', charactersTemplate);</span><br>
  </li>
  <li class="exercise-step">With the <strong>star-wars</strong> database and JavaScript selected, click <strong>Run</strong>.</li>
  <li class="exercise-step">See that null is returned, indicating no errors.</li>
  <li class="exercise-step">Select the second tab, <strong>SQL</strong>:<br>
    <br>
    <span class="code">SELECT * FROM characters</span><br>
  </li>
  <li class="exercise-step">With the <strong>star-wars</strong> database and JavaScript selected, and the Query Type set to <strong>SQL</strong>, click <strong>Run</strong>.</li>
  <li class="exercise-step">See that rows are returned:<br>
    <br>
    <img src="../images/unit06/characters_results.png" width="700" height="250" class="image-border"><br>
  </li>
  <li class="exercise-step">If desired, in a browser window, navigate to <a href="https://docs.marklogic.com/guide/sql" target="_blank">docs.marklogic.com/guide/sql</a> to learn more about creating templates, as well as the steps for setting up an ODBC server port and installing the MarkLogic ODBC driver, for being able to make SQL queries to a MarkLogic database from a business intelligence tool:<br>
    <br>
    <img src="../images/unit06/sql_guide.png" width="601" height="307" class="image-border"></li></ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Next: <a href="06f1_summary.htm">Summary (Unit 6)</a></p>
<p>Back: <a href="0606_serving_data_to_a_bi_tool.htm">Previous</a></p>
<hr>
<p class="copyright">©2015-2020 MarkLogic Corporation. All rights reserved. Copying, selling, or otherwise distributing any part of this course without prior written consent of an authorized representative of MarkLogic Corporation is prohibited.</p>
</body>
</html>
